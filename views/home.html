<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Suchauftrag System - Home</title>
    <link rel="stylesheet" href="/home.css" />
  </head>
  <body>
    <header>
      <nav>
        <h1><a href="/">Suchauftrag System</a></h1>
        <div id="nav-links" class="nav-links"></div>
      </nav>
    </header>

    <main>
      <div id="content-area">
        <!-- Inhalt wird dynamisch geladen -->
      </div>
    </main>

    <script>
      // Pr√ºfen ob User eingeloggt ist
      fetch("/api/suchauftraege")
        .then((response) => {
          if (response.ok) {
            // User ist eingeloggt
            showLoggedInContent();
          } else {
            // User ist nicht eingeloggt
            showGuestContent();
          }
        })
        .catch(() => showGuestContent());

      function showLoggedInContent() {
        document.getElementById("nav-links").innerHTML = `
                <a href="/" class="active">Home</a>
                <a href="/dashboard">Dashboard</a>
                <a href="/logout">Logout</a>
            `;

        document.getElementById("content-area").innerHTML = `
                <div class="form-container">
                    <div class="form-header">
                        <h2>Neuen Suchauftrag erstellen</h2>
                        <p>Geben Sie die Adresse ein, f√ºr die Sie einen Suchauftrag anlegen m√∂chten.</p>
                    </div>
                    
                    ${getUrlMessage()}
                    
                    <form action="/api/suchauftrag" method="POST" class="address-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="plz">PLZ</label>
                                <input type="text" id="plz" name="plz" required maxlength="5" pattern="[0-9]{5}" placeholder="12345">
                            </div>
                            
                            <div class="form-group">
                                <label for="stadt">Stadt</label>
                                <input type="text" id="stadt" name="stadt" required placeholder="Berlin">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="strasse">Stra√üe</label>
                            <input type="text" id="strasse" name="strasse" required placeholder="Hauptstra√üe">
                        </div>
                        
                        <div class="form-group">
                            <label for="hausnummer">Hausnummer</label>
                            <input type="text" id="hausnummer" name="hausnummer" required placeholder="42">
                        </div>
                        
                        <button type="submit" class="submit-btn">SUCHAUFTRAG SPEICHERN</button>
                    </form>
                </div>
            `;
      }

      function showGuestContent() {
        document.getElementById("nav-links").innerHTML = `
                <a href="/" class="active">Home</a>
                <a href="/login">Login</a>
                <a href="/register">Registrieren</a>
            `;

        document.getElementById("content-area").innerHTML = `
                <div class="hero-section">
                    <div class="hero-content">
                        <h2>Professionelle Suchauftragsverwaltung</h2>
                        <p>Verwalten Sie Ihre Adressen und Suchauftr√§ge mit unserem modernen System. Sicher, schnell und zuverl√§ssig.</p>
                        <div class="button-group">
                            <a href="/login" class="btn-primary">Jetzt anmelden ‚Üí</a>
                            <a href="/register" class="btn-secondary">Kostenlos registrieren</a>
                        </div>
                    </div>
                </div>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="feature-icon">üîí</span>
                        <h3>Sicher & Gesch√ºtzt</h3>
                        <p>Ihre Daten sind bei uns sicher. Verschl√ºsselte √úbertragung und sichere Speicherung garantiert.</p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">‚ö°</span>
                        <h3>Blitzschnell</h3>
                        <p>Erstellen Sie Suchauftr√§ge in Sekunden. Unsere optimierte Plattform sorgt f√ºr beste Performance.</p>
                    </div>
                    <div class="feature-card">
                        <span class="feature-icon">üìä</span>
                        <h3>√úbersichtlich</h3>
                        <p>Behalten Sie alle Ihre Suchauftr√§ge im Blick. Strukturierte Darstellung f√ºr maximale Effizienz.</p>
                    </div>
                </div>
                
                <div class="cta-section">
                    <div class="cta-content">
                        <h3>Bereit durchzustarten?</h3>
                        <p>Werden Sie Teil unserer wachsenden Community und optimieren Sie Ihre Arbeitsabl√§ufe.</p>
                        <a href="/register" class="btn-primary">Jetzt kostenlos starten ‚Üí</a>
                    </div>
                </div>
            `;
      }

      function getUrlMessage() {
        const params = new URLSearchParams(window.location.search);
        if (params.get("success") === "1") {
          return '<div class="message success">Suchauftrag erfolgreich gespeichert!</div>';
        }
        if (params.get("error") === "1") {
          return '<div class="message error">Fehler beim Speichern des Suchauftrags.</div>';
        }
        return "";
      }
    </script>
  </body>
</html>
